webpackJsonp([10],{RHMX:function(t,e){},cdb6:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("mvHQ"),a=s.n(n),o=s("Xxa5"),i=s.n(o),r=s("exGp"),c=s.n(r),l=s("PKHo"),d=s("RROI"),u=s("GKmE"),h={props:{type:{type:String,default:"snake"},color:{type:String,default:"#FEA512"},text:{type:String,default:"加载中..."},loadAll:{type:Boolean,default:!1},show:{type:Boolean,default:!1},loadAllText:{type:String,default:"已经加载完啦"}},data:function(){return{func:null}},mounted:function(){var t=this,e=function(){var e=document.body,s=e.scrollHeight-e.clientHeight,n=document.documentElement,a=n.scrollHeight-n.clientHeight;Math.max(e.scrollTop,n.scrollTop)>=Math.max(s,a)&&(console.log("testing"),t.$emit("reach"))};window.addEventListener("scroll",e),this.func=e},methods:{destory:function(){window.removeEventListener("scroll",this.func)}}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.show||t.loadAll?s("div",{staticClass:"on-reach-bottom pw24 f fc jc h60 c666 f30"},[t.loadAll?t._e():[s("span",{staticClass:"mr20"},[t._v(t._s(t.text))]),t._v(" "),s("mt-spinner",{attrs:{type:t.type,color:t.color,size:20}})],t._v(" "),t.loadAll?s("div",{staticClass:"load-all f fc jc"},[s("div",{staticClass:"ver-line"}),t._v(" "),s("span",{staticClass:"ml10 mr10"},[t._v(t._s(t.loadAllText))]),t._v(" "),s("div",{staticClass:"ver-line"})]):t._e()],2):t._e()},staticRenderFns:[]};var p=s("VU/8")(h,f,!1,function(t){s("RHMX")},null,null).exports,v=s("t1fn"),m={mixins:[l.a],components:{onReachBottom:p,"btn-list":v.a},data:function(){return{domTitle:"门店管理",shopList:[],pageIndex:1,loadMore:!1,loadAll:!1,count:0,bottomStatus:"",beScroll:null,pageSize:10,appId:"",btnList:[{text:"添加门店",eventType:"addShop",icon:"icon-icon_tianjia1",class:"btn-null-blue"}],domain:""}},methods:{goShop:function(t){var e=this;return c()(i.a.mark(function s(){var n;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return u.a.showLoading("请稍候"),s.next=3,d.a.authBeforeIntoShop(t);case 3:(n=s.sent)&&u.a.setCookie("dzDishAdmin",n.loginToken).routerPush(e,"shop/"+t+"/home");case 5:case"end":return s.stop()}},s,e)}))()},editShop:function(t){var e="edit_shop?mode=edit&StoreId="+t.Id+"&shopInfo="+a()(t);u.a.routerPush(this,e)},handleAddShop:function(){var t="edit_shop?mode=create&appId="+this.appId;u.a.routerPush(this,t)},handleReach:function(){var t=this;return c()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loadAll){e.next=2;break}return e.abrupt("return");case 2:return t.pageIndex++,t.loadMore=!0,e.next=6,t.getShopListC();case 6:e.sent,!t.loadAll&&(t.loadMore=!1);case 8:case"end":return e.stop()}},e,t)}))()},switchSettings:function(t){this.shopList[t].isShowSettings?this.shopList[t].isShowSettings=!1:(this.shopList.forEach(function(t){t.isShowSettings=!1}),this.shopList[t].isShowSettings=!0)},closeAll:function(){for(var t=this.shopList.length;t--;)this.shopList[t].isShowSettings=!1},getShopListC:function(){var t=this;return c()(i.a.mark(function e(){var s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.getShopList(t.pageIndex,t.appId);case 2:s=e.sent,t.count=s.total,s.page.length>0&&(t.shopList=t.shopList.concat(t.setDefaultSelect(s.page)),s.page.length<t.pageSize&&(t.loadAll=!0));case 5:case"end":return e.stop()}},e,t)}))()},setDefaultSelect:function(t){for(var e,s=0;e=t[s++];)e.isShowSettings=!1;return t},resetData:function(){this.shopList=[],this.pageIndex=1},handleMainShop:function(t,e){var s=this;return c()(i.a.mark(function n(){var a;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=(t=!t)?"设置为":"撤销",n.next=4,s.$messagebox.confirm("确定该店铺"+a+"主店吗");case 4:return u.a.showLoading("设置中"),n.next=7,d.a.setMainStore(t,e);case 7:return n.sent,n.next=10,s.$toast("设置成功");case 10:s.delayReload();case 11:case"end":return n.stop()}},n,s)}))()},removeStore:function(t){var e=this;return c()(i.a.mark(function s(){return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.$messagebox.confirm("确定删除该店铺吗");case 2:return u.a.showLoading("删除中"),s.next=5,d.a.removeStore(t);case 5:return s.sent,s.next=8,e.$toast("删除成功");case 8:e.delayReload();case 9:case"end":return s.stop()}},s,e)}))()},delayReload:function(){setTimeout(function(){window.location.reload()},500)}},mounted:function(){this.appId=this.$route.query.appId,this.getShopListC()},beforeDestroy:function(){this.$refs.reach.destory()}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"wrapper",staticClass:"my-shop-wrapper"},[s("btn-list",{attrs:{btnList:t.btnList},on:{addShop:t.handleAddShop}}),t._v(" "),s("div",{staticClass:"my-shop-list bg-w",on:{click:t.closeAll}},t._l(t.shopList,function(e,n){return s("div",{staticClass:"shop-item f fc fj rel"},[s("div",{staticClass:"left f"},[s("img",{directives:[{name:"src",rawName:"v-src",value:e.Logo,expression:"item.Logo"}],staticClass:"avator mr20"}),t._v(" "),s("div",{staticClass:"f fv jc f30 c333"},[s("div",{},[t._v(t._s(e.Name)+" "),e.IsMain?s("span",{staticClass:"ml10 t-b theme-color"},[t._v("(主店)")]):t._e()]),t._v(" "),s("div",{staticClass:"phone"},[t._v(t._s(e.Login||" "))])])]),t._v(" "),s("div",{staticClass:"mask abs",on:{click:function(e){e.stopPropagation(),t.switchSettings(n)}}},[s("i",{staticClass:"dzicon icon-icon_shezhi- theme-color-light-red f36"})]),t._v(" "),s("transition",{attrs:{name:"pull-right"}},[e.isShowSettings?s("div",{staticClass:"settings abs cfff f arrow_box"},[s("div",{staticClass:"f fc f26 settings-item rel",on:{click:function(s){t.removeStore(e.Id)}}},[s("div",[t._v("删除")]),t._v(" "),s("div",{staticClass:"line abs"})]),t._v(" "),s("div",{staticClass:"f fc f26 settings-item rel",on:{click:function(s){t.editShop(e)}}},[s("div",[t._v("编辑")]),t._v(" "),s("div",{staticClass:"line abs"})]),t._v(" "),s("div",{staticClass:"f fc f26 settings-item rel",on:{click:function(s){t.handleMainShop(e.IsMain,e.Id)}}},[s("div",[t._v(t._s(e.IsMain?"撤销主店":"设为主店"))]),t._v(" "),s("div",{staticClass:"line abs"})]),t._v(" "),s("div",{staticClass:"f fc f26 settings-item rel",on:{click:function(s){s.stopPropagation(),t.goShop(e.Id)}}},[s("div",[t._v("进入店铺")])])]):t._e()])],1)})),t._v(" "),s("onReachBottom",{ref:"reach",attrs:{show:t.loadMore,loadAll:t.loadAll},on:{reach:t.handleReach}})],1)},staticRenderFns:[]};var _=s("VU/8")(m,g,!1,function(t){s("xjTX")},null,null);e.default=_.exports},xjTX:function(t,e){}});